# Development Environment Configuration
# For local testing and development

trading:
  paper_trading_mode: true
  allow_short_selling: true
  allow_options_trading: false  # Disable options in dev

  watchlist_symbols:
    - RELIANCE.NS
    - TCS.NS
    - INFY.NS
    - HDFCBANK.NS
    - ICICIBANK.NS
  max_watchlist_size: 20

  price_update_interval_seconds: 10  # Slower for dev
  eod_data_fetch_time: "15:45"

  position_limits:
    initial_capital: 50000.0
    max_position_size_percent: 20.0
    max_deployed_capital_percent: 80.0
    cash_buffer_percent: 20.0
    max_swing_positions: 3  # Reduced for dev
    max_intraday_positions: 1
    max_options_positions: 1
    max_positions_per_sector: 2
    min_sectors_required: 2

  trading_hours:
    market_open: "09:15"
    market_close: "15:30"
    intraday_entry_cutoff: "14:30"
    auto_square_time: "15:15"
    post_market_start: "15:45"
    avoid_first_n_minutes: 15
    avoid_last_n_minutes: 15

  order_execution:
    default_entry_order_type: MARKET
    default_exit_order_type: MARKET
    use_bracket_orders: false
    expected_slippage_percent: 0.1
    max_acceptable_slippage_percent: 0.5
    order_timeout_seconds: 30
    max_retry_attempts: 3
    retry_delay_seconds: 2

  strategy:
    enabled_strategies:
      - TREND_RSI
      - MEAN_REVERSION
    strategy_weights:
      TREND_RSI: 0.5
      MEAN_REVERSION: 0.5
    min_signal_strength: 65.0
    require_timeframe_alignment: false  # Disabled for dev
    min_alignment_score: 70.0

  timeframes:
    swing_primary_timeframe: 1d
    intraday_primary_timeframe: 15m
    enabled_timeframes:
      - 1d
      - 1h
      - 15m
    timeframe_weights:
      1d: 0.5
      1h: 0.3
      15m: 0.2

risk:
  risk_management_enabled: true
  strict_mode: false  # Allow overrides in dev
  daily_risk_report: true
  alert_on_limit_approach: true
  alert_threshold_percent: 80.0

  loss_limits:
    risk_per_trade_percent: 1.0
    max_risk_per_trade_amount: 500.0
    max_daily_loss_percent: 3.0
    max_daily_loss_amount: 1500.0
    max_weekly_loss_percent: 6.0
    max_weekly_loss_amount: 3000.0
    max_monthly_drawdown_percent: 10.0
    max_monthly_drawdown_amount: 5000.0
    max_intraday_loss_percent: 2.0
    max_intraday_loss_amount: 1000.0
    max_consecutive_losses: 3
    cooldown_after_consecutive_losses_minutes: 60

  stop_loss:
    default_stop_type: PERCENTAGE
    fixed_sl_enabled: true
    percentage_sl_enabled: true
    default_sl_percent: 2.0
    max_sl_percent: 5.0
    trailing_sl_enabled: true
    trailing_activation_percent: 2.0
    trailing_distance_percent: 1.0
    atr_sl_enabled: true
    atr_multiplier: 2.0
    time_based_sl_enabled: true
    max_hold_hours_intraday: 4
    max_hold_days_swing: 10

  targets:
    use_targets: true
    min_risk_reward_ratio: 2.0
    default_risk_reward_ratio: 2.5
    enable_partial_exits: true
    first_target_percent: 3.0
    first_target_exit_size: 50.0
    second_target_percent: 5.0
    second_target_exit_size: 50.0
    trail_remainder: true

  circuit_breaker:
    enabled: true
    halt_on_5_percent_drawdown: true
    reduce_size_on_5_percent: true
    size_reduction_percent: 50.0
    halt_on_10_percent_drawdown: true
    stop_new_trades_on_10_percent: true
    halt_on_15_percent_drawdown: true
    close_all_positions_on_15_percent: true
    halt_after_consecutive_losses: 3
    halt_duration_minutes: 60

  position_rules:
    max_correlated_positions: 2
    correlation_threshold: 0.7
    max_sector_exposure_percent: 40.0
    avoid_high_volatility_stocks: true
    max_daily_volatility_percent: 5.0
    min_daily_volume: 100000
    min_market_cap_crores: 1000.0

database:
  schema_version: "1.0"
  auto_migrate: true
  strict_schema_validation: true
  log_queries: true  # Enable in dev for debugging
  log_slow_queries: true
  slow_query_threshold_ms: 1000

  connection:
    db_type: sqlite
    db_path: data/trading_system.db
    timeout: 30
    check_same_thread: false
    isolation_level: DEFERRED
    pool_size: 5
    max_overflow: 10
    pool_timeout: 30

  maintenance:
    enable_auto_backup: true
    backup_frequency_hours: 24
    backup_directory: data/backups
    max_backups_to_keep: 7
    enable_auto_vacuum: true
    vacuum_frequency_days: 7
    enable_auto_archive: false  # Disable in dev
    archive_after_days: 365
    delete_old_market_data_days: 90
    delete_old_logs_days: 30

  performance:
    enable_query_cache: true
    query_cache_size_mb: 50
    query_cache_ttl_seconds: 300
    auto_create_indexes: true
    analyze_frequency_hours: 24
    batch_insert_size: 1000
    enable_batch_commits: true
    use_wal_mode: true

api:
  enable_api_caching: true
  global_timeout_seconds: 30
  log_api_errors: true
  alert_on_api_failure: true
  circuit_breaker_on_failures: true
  max_consecutive_failures: 3
  mock_api_responses: false
  record_api_calls: true  # Enable in dev for debugging

  broker:
    broker_type: paper
    enabled: true
    max_requests_per_second: 10
    max_orders_per_day: 100
    api_timeout_seconds: 30
    websocket_timeout_seconds: 60
    max_retry_attempts: 3
    retry_delay_seconds: 2
    exponential_backoff: true
    max_backoff_seconds: 16
    enable_failover: false

  data_source:
    primary_source: yfinance
    realtime_source: yfinance  # Use yfinance for paper trading
    historical_sources:
      - yfinance
      - nsetools
    enable_fallback: true
    fallback_sources:
      - alpha_vantage
    max_retries_per_source: 2
    source_timeout_seconds: 30
    cache_data: true
    cache_ttl_seconds: 300
    validate_data_quality: true
    reject_outliers: true
    outlier_threshold_std: 3.0

  websocket:
    enabled: false  # Disabled for paper trading
    auto_reconnect: true
    reconnect_delay_seconds: 5
    max_reconnect_attempts: 10
    ping_interval_seconds: 30
    pong_timeout_seconds: 10
